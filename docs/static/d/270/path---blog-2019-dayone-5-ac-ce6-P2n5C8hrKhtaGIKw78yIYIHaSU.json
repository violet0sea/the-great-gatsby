{"data":{"markdownRemark":{"html":"<p>Gatsby 是一个基于 React 和 Graphql 的静态 html 构建网站，使用 SSR 技术；在用于博客搭建时，使用 markdown 文件写作；原理就是通过文件系统加载 markdown 文件，然后使用 markdownRemark 转化为 html，然后在利用 graphql 获取相应的数据，通过 templates 模板渲染出 Dom。</p>\n<h3>快速开始</h3>\n<ol>\n<li>为了使用 gatsby-cli，建议全局安装</li>\n</ol>\n<pre><code class=\"language-sh\">$ yarn add gatsby -g\nor npm add gatsby -g\n</code></pre>\n<ol start=\"2\">\n<li>使用 gatsby <strong>new</strong> 新建一个项目，安装项目依赖</li>\n</ol>\n<pre><code class=\"language-sh\">$ gatsby new &#x3C;project-name>\ncd &#x3C;project-name>\nyarn install\n</code></pre>\n<ol start=\"3\">\n<li>启动项目</li>\n</ol>\n<pre><code class=\"language-sh\">$ gatsby develop\nor  yarn start\nor  yarn develop\n</code></pre>\n<ol start=\"4\">\n<li>打开<a href=\"http://localhost:8000\">http://localhost:8000</a></li>\n</ol>\n<p>一个基本的骨架搭建完毕，快速教程参考\n<a href=\"https://www.gatsbyjs.org/blog/2017-07-19-creating-a-blog-with-gatsby/\">creating a blog with gatsby</a></p>\n<h3>关键点</h3>\n<ol>\n<li>安装<strong>gatsby-source-filesystem</strong> 和 <strong>gatsby-transformer-remark</strong> 两个插件分别用于文件读取和文件转化</li>\n<li>markdown 文件里含有 frontmatter 部分，这些数据都会被转化并注入到 react 组建里以供使用</li>\n</ol>\n<pre><code>---\npath: '/define-path-to-you-blog'\ntitle: 'how to use gatsby to develop a blog'\ndate: '2019-04-21'\n---\n</code></pre>\n<p>，其中 path 字段可以用来规定页面路由，实际上使用文件的路径也是可行的，但是使用 path 字段的灵活性会更好；要实现使用 path 作为路由需要变更两个地方：</p>\n<ol>\n<li>gatsby-node.js 文件里的 createPage 方法里的 path 需要通过 graphql 获取并指定</li>\n</ol>\n<pre><code class=\"language-js\">exports.createPages = ({ graphql, actions }) => {\n  const { createPage } = actions;\n  return graphql(`\n    {\n      allMarkdownRemark {\n        edges {\n          node {\n            frontmatter {\n              path // 获取markdown里的path\n            }\n            fields {\n              slug\n            }\n          }\n        }\n      }\n    }\n  `).then(result => {\n    result.data.allMarkdownRemark.edges.forEach(({ node }) => {\n      createPage({\n        path: node.frontmatter.path, // 设置为对应的path\n        component: path.resolve('./src/templates/blog.js'),\n        context: {\n          slug: node.fields.slug,\n        },\n      });\n    });\n  });\n};\n</code></pre>\n<ol>\n<li>路由条状的地方也需要通过 graphql 获取 path</li>\n</ol>\n<pre><code class=\"language-js\">const IndexPage = ({ data }) => (\n  &#x3C;Layout>\n    &#x3C;SEO title=\"Home\" keywords={[`gatsby`, `application`, `react`]} />\n\n    &#x3C;ul>\n      {data.allMarkdownRemark.edges.map(({ node }) => (\n        &#x3C;li key={node.id}>\n          &#x3C;Link to={node.frontmatter.path}>\n            &#x3C;h3>{node.frontmatter.title}&#x3C;/h3>\n            &#x3C;span>{node.frontmatter.date}&#x3C;/span>\n            &#x3C;p>{node.excerpt}&#x3C;/p>\n          &#x3C;/Link>\n        &#x3C;/li>\n      ))}\n    &#x3C;/ul>\n  &#x3C;/Layout>\n);\n\nexport const query = graphql`\n  query homepagePostQuery {\n    allMarkdownRemark {\n      edges {\n        node {\n          id\n          frontmatter {\n            title\n            date\n            path\n          }\n          fields {\n            slug\n          }\n          excerpt\n        }\n      }\n    }\n  }\n`;\n</code></pre>","frontmatter":{"title":"how to use gatsby to develop a blog"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/2019/dayone/"}}